document.addEventListener("DOMContentLoaded",()=>{let i,c;let e=false;const n=t=>{const e=t=>Array.from(t).reduce((t,e)=>t+e.offsetWidth,0);if(t){const o=e(document.querySelector("#blog-info > a").children);const s=e(document.getElementById("menus").children);i=o+s;c=document.getElementById("nav")}const n=window.innerWidth<=768||i>c.offsetWidth-120;c.classList.toggle("hide-menu",n)};const t=()=>{n(true);c.classList.add("show")};const o={open:()=>{btf.overflowPaddingR.add();btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s");document.getElementById("sidebar-menus").classList.add("open");e=true},close:()=>{btf.overflowPaddingR.remove();btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s");document.getElementById("sidebar-menus").classList.remove("open");e=false}};const s=()=>{const t=()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)};const e=document.getElementById("scroll-down");e&&btf.addEventListenerPjax(e,"click",t)};const a=()=>{const t=GLOBAL_CONFIG.highlight;if(!t)return;const{highlightCopy:e,highlightLang:n,highlightHeightLimit:i,highlightFullpage:o,highlightMacStyle:s,plugin:c}=t;const a=GLOBAL_CONFIG_SITE.isHighlightShrink;const r=e||n||a!==undefined||o||s;const l=c==="highlight.js"?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if(!((r||i)&&l.length))return;const d=c==="prismjs";const u=a===true?"closed":"";const f=a!==undefined?'<i class="fas fa-angle-down expand"></i>':"";const g=e?'<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>':"";const m='<div class="macStyle"><div class="mac-close"></div><div class="mac-minimize"></div><div class="mac-maximize"></div></div>';const h=o?'<i class="fa-solid fa-up-right-and-down-left-from-center fullpage-button"></i>':"";const p=(t,e)=>{if(GLOBAL_CONFIG.Snackbar!==undefined){btf.snackbarShow(e)}else{t.textContent=e;t.style.opacity=1;setTimeout(()=>{t.style.opacity=0},800)}};const b=async(t,e)=>{try{await navigator.clipboard.writeText(t);p(e,GLOBAL_CONFIG.copy.success)}catch(t){console.error("Failed to copy: ",t);p(e,GLOBAL_CONFIG.copy.noSupport)}};const L=(t,e)=>{const n=t.parentNode;n.classList.add("copy-true");const o=d?"pre code":"table .code pre";const s=n.querySelector(o);if(!s)return;b(s.innerText,e.previousElementSibling);n.classList.remove("copy-true")};const y=t=>t.classList.toggle("closed");const v=(t,e)=>{const n=t.closest("figure.highlight");const o=n.classList.toggle("code-fullpage");document.body.style.overflow=o?"hidden":"";e.classList.toggle("fa-down-left-and-up-right-to-center",o);e.classList.toggle("fa-up-right-and-down-left-from-center",!o)};const w=t=>{const e=t.target.classList;const n=t.currentTarget;if(e.contains("expand"))y(n);else if(e.contains("copy-button"))L(n,t.target);else if(e.contains("fullpage-button"))v(n,t.target)};const E=t=>t.currentTarget.classList.toggle("expand-done");const I=e=>{const o=new Map;const t=()=>{let t=e;while(t!==document.body&&t!=null){if(window.getComputedStyle(t).display==="none"){o.set(t,t.getAttribute("style")||"")}t=t.parentNode}const n="visibility: hidden !important; display: block !important;";o.forEach((t,e)=>{e.setAttribute("style",t?t+";"+n:n)})};const n=()=>{o.forEach((t,e)=>{if(t==="")e.removeAttribute("style");else e.setAttribute("style",t)})};t();const s=e.offsetHeight;n();return s};const G=(t,e)=>{const n=document.createDocumentFragment();if(r){const o=document.createElement("div");o.className=`highlight-tools ${u}`;o.innerHTML=m+f+t+g+h;btf.addEventListenerPjax(o,"click",w);n.appendChild(o)}if(i&&I(e)>i+30){const s=document.createElement("div");s.className="code-expand-btn";s.innerHTML='<i class="fas fa-angle-double-down"></i>';btf.addEventListenerPjax(s,"click",E);n.appendChild(s)}d?e.parentNode.insertBefore(n,e):e.insertBefore(n,e.firstChild)};l.forEach(t=>{let e="";if(d)btf.wrap(t,"figure",{class:"highlight"});if(!n){G("",t);return}if(d){e=t.getAttribute("data-language")||"Code"}else{e=t.getAttribute("class").split(" ")[1];if(e==="plain"||e===undefined)e="Code"}G(`<div class="code-lang">${e}</div>`,t)})};const r=()=>{if(!GLOBAL_CONFIG.isPhotoFigcaption)return;document.querySelectorAll("#article-container img").forEach(t=>{const e=t.title||t.alt;if(!e)return;const n=document.createElement("div");n.className="img-alt text-center";n.textContent=e;t.insertAdjacentElement("afterend",n)})};const l=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))};const d=async t=>{try{const e=await fetch(t);return await e.json()}catch(t){console.error("Failed to fetch URL:",t);return[]}};const u=(i,s,t)=>{const{isButton:c,limit:n,firstLimit:a,tabs:r}=t;const e=s.length;const l=Math.ceil((e-a)/n+1);const o={gap:5,isConstantSize:true,sizeRange:[150,600],useTransform:true};const d=new InfiniteGrid.JustifiedInfiniteGrid(i,o);let u=false;const f=t=>t&&t.replace(/"/g,"&quot;")||"";const g=t=>{const e=t.alt?`alt="${f(t.alt)}"`:"";const n=t.title?`title="${f(t.title)}"`:"";return`<div class="item">
        <img src="${t.url}" data-grid-maintained-target="true" ${e} ${n} />
      </div>`};const m=(t,e,n=false)=>{const o=n?(t-1)*e:(t-2)*e+a;return s.slice(o,o+e).map(g)};const h=t=>{const e=document.createElement("button");e.innerHTML=`${GLOBAL_CONFIG.infinitegrid.buttonText}<i class="fa-solid fa-arrow-down"></i>`;e.addEventListener("click",()=>{e.remove();btf.setLoading.add(t);p(d.getGroups().length+1,n)},{once:true});t.insertAdjacentElement("afterend",e)};const p=(t,e,n)=>{d.append(m(t,e,n),t)};const b=t=>{if(r){const s=i.parentNode;if(u){s.style.visibility="visible"}if(i.offsetHeight===0){s.style.visibility="hidden";u=true}}const{updated:e,isResize:n,mounted:o}=t;if(!e.length||!o.length||n)return;btf.loadLightbox(i.querySelectorAll("img:not(.medium-zoom-image)"));if(d.getGroups().length===l){btf.setLoading.remove(i);!r&&d.off("renderComplete",b);return}if(c){btf.setLoading.remove(i);h(i)}};const L=btf.debounce(t=>{const e=(+t.groupKey||0)+1;if(e===1)p(e,a,true);else p(e,n);if(e===l)d.off("requestAppend",L)},300);btf.setLoading.add(i);d.on("renderComplete",b);if(c){p(1,a,true)}else{d.on("requestAppend",L);d.renderItems()}btf.addGlobalFn("pjaxSendOnce",()=>d.destroy())};const f=async(i,c=false)=>{if(!i.length)return;const t=async()=>{for(const t of i){if(btf.isHidden(t)||t.classList.contains("loaded"))continue;const e={isButton:t.getAttribute("data-button")==="true",limit:parseInt(t.getAttribute("data-limit"),10),firstLimit:parseInt(t.getAttribute("data-first"),10),tabs:c};const n=t.firstElementChild;const o=n.textContent;n.textContent="";t.classList.add("loaded");try{const s=t.getAttribute("data-type")==="url"?await d(o):JSON.parse(o);u(n,s,e)}catch(t){console.error("Gallery data parsing failed:",t)}}};if(typeof InfiniteGrid==="function"){await t()}else{await btf.getScript(GLOBAL_CONFIG.infinitegrid.js);await t()}};const g=t=>{const e=btf.getScrollPercent(t,document.body);const n=document.getElementById("go-up");if(e<95){n.classList.add("show-percent");n.querySelector(".scroll-percent").textContent=e}else{n.classList.remove("show-percent")}};const m=()=>{const n=document.getElementById("rightside");const t=window.innerHeight+56;let o=0;const s=document.getElementById("page-header");const i=typeof chatBtn!=="undefined";const c=GLOBAL_CONFIG.percent.rightside;const a=()=>{if(document.body.scrollHeight<=t){n.classList.add("rightside-show");return true}return false};if(a())return;const r=t=>{const e=t>o;o=t;return e};let l="";const e=btf.throttle(()=>{const t=window.scrollY||document.documentElement.scrollTop;const e=r(t);if(t>56){if(l===""){s.classList.add("nav-fixed");n.classList.add("rightside-show")}if(e){if(l!=="down"){s.classList.remove("nav-visible");i&&window.chatBtn.hide();l="down"}}else{if(l!=="up"){s.classList.add("nav-visible");i&&window.chatBtn.show();l="up"}}}else{l="";if(t===0){s.classList.remove("nav-fixed","nav-visible")}n.classList.remove("rightside-show")}c&&g(t);a()},300);btf.addEventListenerPjax(window,"scroll",e,{passive:true})};const h=()=>{const a=GLOBAL_CONFIG_SITE.isToc;const t=GLOBAL_CONFIG.isAnchor;const e=document.getElementById("article-container");if(!(e&&(a||t)))return;let r,l,d,n,u;if(a){const i=document.getElementById("card-toc");l=i.querySelector(".toc-content");r=l.querySelectorAll(".toc-link");n=i.querySelector(".toc-percentage");u=l.classList.contains("is-expand");const c=t=>{const e=t.target.closest(".toc-link");if(!e)return;t.preventDefault();btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(e.getAttribute("href")).replace("#",""))),300);if(window.innerWidth<900){i.classList.remove("open")}};btf.addEventListenerPjax(l,"click",c);d=t=>{const e=l.clientHeight;const n=t.offsetTop;const o=t.clientHeight;const s=l.scrollTop;const i=n-s;const c=(e-o)/2;if(i!==c){l.scrollTop=s+(i-c)}};l.style.display="block"}const f=e.querySelectorAll("h1,h2,h3,h4,h5,h6");let g="";const o=e=>{if(e===0)return false;let n="";let o="";for(let t=0;t<f.length;t++){const s=f[t];if(e>btf.getEleTop(s)-80){const i=s.id;n=i?"#"+encodeURI(i):"";o=t}else{break}}if(g===o)return;if(t)btf.updateAnchor(n);g=o;if(a){l.querySelectorAll(".active").forEach(t=>t.classList.remove("active"));if(n){const c=r[o];c.classList.add("active");setTimeout(()=>d(c),0);if(!u){let t=c.parentNode;while(!t.matches(".toc")){if(t.matches("li"))t.classList.add("active");t=t.parentNode}}}}};const s=btf.throttle(()=>{const t=window.scrollY||document.documentElement.scrollTop;if(a&&GLOBAL_CONFIG.percent.toc){n.textContent=btf.getScrollPercent(t,e)}o(t)},100);btf.addEventListenerPjax(window,"scroll",s,{passive:true})};const p=n=>{const t=window.globalFn||{};const o=t.themeChange||{};if(!o){return}Object.keys(o).forEach(t=>{const e=o[t];if(["disqus","disqusjs"].includes(t)){setTimeout(()=>e(n),300)}else{e(n)}})};const b={readmode:()=>{const t=document.body;const e=document.createElement("button");const n=()=>{t.classList.remove("read-mode");e.remove();e.removeEventListener("click",n)};t.classList.add("read-mode");e.type="button";e.className="fas fa-sign-out-alt exit-readmode";e.addEventListener("click",n);t.appendChild(e)},darkmode:()=>{const t=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";if(t==="dark"){btf.activateDarkMode();GLOBAL_CONFIG.Snackbar!==undefined&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)}else{btf.activateLightMode();GLOBAL_CONFIG.Snackbar!==undefined&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)}btf.saveToLocal.set("theme",t,2);p(t)},"rightside-config":t=>{const e=t.firstElementChild;if(e.classList.contains("show")){e.classList.add("status");setTimeout(()=>{e.classList.remove("status")},300)}e.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{const t=document.documentElement.classList;const e=t.contains("hide-aside")?"show":"hide";btf.saveToLocal.set("aside-status",e,2);t.toggle("hide-aside")},"mobile-toc-button":(t,e)=>{const n=document.getElementById("card-toc");n.style.transition="transform 0.3s ease-in-out";const o=n.clientHeight;const s=e.getBoundingClientRect();const i=window.innerHeight-s.bottom-30;if(o>i){n.style.transformOrigin=`right ${o-i-s.height/2}px`}n.classList.toggle("open");n.addEventListener("transitionend",()=>{n.style.cssText=""},{once:true})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}};document.getElementById("rightside").addEventListener("click",t=>{const e=t.target.closest("[id]");if(e&&b[e.id]){b[e.id](t.currentTarget,e)}});const L=()=>{const t=t=>{const e=t.target.closest(".site-page.group");if(!e)return;e.classList.toggle("hide")};const e=document.querySelector("#sidebar-menus .menus_items");e&&e.addEventListener("click",t)};const y=()=>{const t=document.getElementById("toggle-menu");if(!t)return;btf.addEventListenerPjax(t,"click",()=>{o.open()})};const v=()=>{const{limitCount:o,languages:s}=GLOBAL_CONFIG.copyright;const t=t=>{t.preventDefault();const e=window.getSelection(0).toString();let n=e;if(e.length>o){n=`${e}\n\n\n${s.author}\n${s.link}${window.location.href}\n${s.source}\n${s.info}`}if(t.clipboardData){return t.clipboardData.setData("text",n)}else{return window.clipboardData.setData("text",n)}};document.body.addEventListener("copy",t)};const w=()=>{const t=document.getElementById("runtimeshow");if(t){const e=t.getAttribute("data-publishDate");t.textContent=`${btf.diffDate(e)} ${GLOBAL_CONFIG.runtime}`}};const E=()=>{const t=document.getElementById("last-push-date");if(t){const e=t.getAttribute("data-lastPushDate");t.textContent=btf.diffDate(e,true)}};const I=()=>{const t=document.querySelectorAll("#article-container table");if(!t.length)return;t.forEach(t=>{if(!t.closest(".highlight")){btf.wrap(t,"div",{class:"table-wrap"})}})};const G=()=>{const t=document.querySelectorAll("#article-container .hide-button");if(!t.length)return;t.forEach(t=>t.addEventListener("click",t=>{const e=t.currentTarget;e.classList.add("open");f(e.nextElementSibling.querySelectorAll(".gallery-container"))},{once:true}))};const A=()=>{const t=document.querySelectorAll("#article-container .tabs");if(!t.length)return;const i=(t,n)=>{t.forEach((t,e)=>{t.classList.toggle("active",e===n)})};const e=t=>{const e=t.target.closest("button");if(!e||e.classList.contains("active"))return;const n=[...t.currentTarget.children];const o=[...t.currentTarget.nextElementSibling.children];const s=n.indexOf(e);i(n,s);t.currentTarget.classList.remove("no-default");i(o,s);f(o[s].querySelectorAll(".gallery-container"),true)};const n=e=>t=>{if(t.target.closest("button")){btf.scrollToDest(btf.getEleTop(e),300)}};t.forEach(t=>{btf.addEventListenerPjax(t.firstElementChild,"click",e);btf.addEventListenerPjax(t.lastElementChild,"click",n(t))})};const O=()=>{const t=document.querySelector("#aside-cat-list.expandBtn");if(!t)return;const e=t=>{const e=t.target;if(e.nodeName==="I"){t.preventDefault();e.parentNode.classList.toggle("expand")}};btf.addEventListenerPjax(t,"click",e,true)};const B=()=>{const t=document.getElementById("post-outdate-notice");if(!t)return;const{limitDay:e,messagePrev:n,messageNext:o,postUpdate:s}=JSON.parse(t.getAttribute("data"));const i=btf.diffDate(s);if(i>=e){t.textContent=`${n} ${i} ${o}`;t.hidden=false}};const C=()=>{window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"});btf.addGlobalFn("pjaxComplete",()=>{window.lazyLoadInstance.update()},"lazyload")};const S=t=>{t.forEach(t=>{t.textContent=btf.diffDate(t.getAttribute("datetime"),true);t.style.display="inline"})};const x=()=>{const t=document.getElementById("recent-posts");if(!(t&&t.classList.contains("masonry")))return;const e=()=>{const t=new InfiniteGrid.MasonryInfiniteGrid(".recent-post-items",{gap:{horizontal:10,vertical:20},useTransform:true,useResizeObserver:true});t.renderItems();btf.addGlobalFn("pjaxCompleteOnce",()=>{t.destroy()},"removeJustifiedIndexPostUI")};typeof InfiniteGrid==="function"?e():btf.getScript(`${GLOBAL_CONFIG.infinitegrid.js}`).then(e)};const T=()=>{window.addEventListener("resize",()=>{n(false);e&&btf.isHidden(document.getElementById("toggle-menu"))&&o.close()});const t=document.getElementById("menu-mask");t&&t.addEventListener("click",()=>{o.close()});L();GLOBAL_CONFIG.islazyloadPlugin&&C();GLOBAL_CONFIG.copyright!==undefined&&v();if(GLOBAL_CONFIG.autoDarkmode){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",t=>{if(btf.saveToLocal.get("theme")!==undefined)return;t.matches?p("dark"):p("light")})}};const k=()=>{a();r();f(document.querySelectorAll("#article-container .gallery-container"));l();h();I();G();A()};const F=()=>{t();x();if(GLOBAL_CONFIG_SITE.pageType==="post"){B();GLOBAL_CONFIG.relativeDate.post&&S(document.querySelectorAll("#post-meta time"))}else{GLOBAL_CONFIG.relativeDate.homepage&&S(document.querySelectorAll("#recent-posts time"));GLOBAL_CONFIG.runtime&&w();E();O()}GLOBAL_CONFIG_SITE.pageType==="home"&&s();m();k();GLOBAL_CONFIG_SITE.pageType!=="shuoshuo"&&btf.switchComments(document);y()};btf.addGlobalFn("pjaxComplete",F,"refreshFn");F();T();window.addEventListener("hexo-blog-decrypt",t=>{k();window.translateFn.translateInitialization();Object.values(window.globalFn.encrypt).forEach(t=>{t()})})});