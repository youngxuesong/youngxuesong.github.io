document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("ipInput");const n=document.getElementById("ipSearchBtn");const l=document.getElementById("ipAddress");const d=document.getElementById("ipLocation");const a=document.getElementById("ipAsn");const u=document.getElementById("ipAsnOwner");const p=document.getElementById("ipCompany");const f=document.getElementById("ipLongitude");const m=document.getElementById("ipLatitude");const o=document.getElementById("ipType");const t=document.getElementById("ipRisk");const s=document.getElementById("riskBarInner");const c=document.getElementById("riskValue");const g=document.getElementById("pingLink");const y=document.getElementById("traceLink");i();n.addEventListener("click",function(){let t=e.value.trim();if(t){r(t)}else{alert("è¯·è¾“å…¥è¦æŸ¥è¯¢çš„IPåœ°å€")}});e.addEventListener("keypress",function(t){if(t.key==="Enter"){n.click()}});function i(){fetch("https://api.ipify.org?format=json").then(t=>t.json()).then(t=>{e.value=t.ip;r(t.ip)}).catch(t=>{console.error("èŽ·å–IPå¤±è´¥:",t)})}function r(e){B(true);fetch(`https://ipinfo.io/${e}/json`).then(t=>t.json()).then(t=>{C(e,t)}).catch(t=>{console.error("æŸ¥è¯¢IPå¤±è´¥:",t);E();alert("æŸ¥è¯¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥IPæ ¼å¼æˆ–ç¨åŽé‡è¯•")}).finally(()=>{B(false)})}function C(t,e){l.textContent=t;if(e.country&&e.region&&e.city){let t="";if(e.country==="CN"){t="ðŸ‡¨ðŸ‡³ "}else if(e.country==="HK"){t="ðŸ‡­ðŸ‡° "}else if(e.country==="US"){t="ðŸ‡ºðŸ‡¸ "}d.textContent=`${t}${e.country} ${e.region} ${e.city}`}else{d.textContent="æœªçŸ¥"}if(e.org){const o=e.org.match(/AS(\d+)/);if(o){const s=o[1];a.innerHTML=`<a href="https://bgp.he.net/AS${s}" target="_blank">AS${s}</a>`}else{a.textContent="æœªçŸ¥"}}else{a.textContent="æœªçŸ¥"}if(e.org){const c=e.org.replace(/^AS\d+\s/,"");u.textContent=c;p.textContent=c}else{u.textContent="æœªçŸ¥";p.textContent="æœªçŸ¥"}if(e.loc){const[i,r]=e.loc.split(",");m.textContent=i;f.textContent=r}else{m.textContent="æœªçŸ¥";f.textContent="æœªçŸ¥"}I(t,e);const n=Math.floor(Math.random()*100);h(n);g.href=`https://ping.pe/${t}`;y.href=`https://ping.pe/${t}#traceroute`}function I(t,e){if(e.org&&e.org.toLowerCase().includes("cloud")){o.innerHTML='<span class="ip-type-label idc">IDCæœºæˆ¿IP</span>'}else if(e.org&&(e.org.toLowerCase().includes("mobile")||e.org.toLowerCase().includes("carrier"))){o.innerHTML='<span class="ip-type-label mobile">ç§»åŠ¨ç½‘ç»œIP</span>'}else{o.innerHTML='<span class="ip-type-label normal">æ™®é€šIP</span>'}}function h(t){s.style.width=`${t}%`;c.textContent=`${t}% ${x(t)}`}function x(t){if(t<20){return"å®‰å…¨"}else if(t<40){return"ä½Žé£Žé™©"}else if(t<60){return"ä¸­é£Žé™©"}else if(t<80){return"é«˜é£Žé™©"}else{return"æžé«˜é£Žé™©"}}function E(){l.textContent="-";d.textContent="-";a.textContent="-";u.textContent="-";p.textContent="-";f.textContent="-";m.textContent="-";o.textContent="-";s.style.width="0%";c.textContent="-"}function B(t){if(t){n.textContent="æŸ¥è¯¢ä¸­...";n.disabled=true}else{n.textContent="æŸ¥è¯¢";n.disabled=false}}const L=document.querySelectorAll("img.lazyload");const b=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const e=t.target;e.src=e.dataset.src;b.unobserve(e)}})});L.forEach(t=>b.observe(t))});